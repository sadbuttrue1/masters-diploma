(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12987,        419]
NotebookOptionsPosition[     12499,        398]
NotebookOutlinePosition[     12853,        414]
CellTagsIndexPosition[     12810,        411]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"fontName", "=", "\"\<Times\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.002", "]"}], ",", "13", ",", "fontName"}],
       "]"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"GridLinesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.001", "]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"FontFamily", "\[Rule]", "fontName"}], ")"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ";", 
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7048027282581997`*^9, 3.704802731081056*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], ",", 
     RowBox[{"y", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"a", "[", "t", "]"}]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "l"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", "t", "]"}], "-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ",", 
     RowBox[{"l", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", "t", "]"}], "-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3", "=", 
   RowBox[{"r0", "+", "A"}]}], ";", 
  RowBox[{"r2", "=", 
   RowBox[{"r3", "+", "L"}]}], ";", 
  RowBox[{"r1", "=", 
   RowBox[{"r3", "-", "L"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"r1", "-", "r0"}]}], ";", "   ", 
  RowBox[{"R2", "=", 
   RowBox[{"r2", "-", "r0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r0", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r1", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r2", ",", "t"}], "]"}]}], ";", 
  RowBox[{"v3", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r3", ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704802734599865*^9, 3.70480273549128*^9}, {
  3.704802901886119*^9, 3.70480290513726*^9}, {3.7048030009918633`*^9, 
  3.704803008672814*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"F3", "=", 
   RowBox[{
    FractionBox["n", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "3"]], "A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    FractionBox["p", 
     RowBox[{"a", "[", "t", "]"}]], "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U0", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            SubscriptBox["k", "\[Alpha]"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["k", "\[Alpha]t"], " ", 
            RowBox[{
             SuperscriptBox["\[Alpha]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "+", 
         RowBox[{
          SubscriptBox["k", "x"], 
          RowBox[{"x", "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["k", "xt"], 
          RowBox[{
           RowBox[{"x", "'"}], "[", "t", "]"}]}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["k", "\[Alpha]"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["k", "\[Alpha]t"], " ", 
            RowBox[{
             SuperscriptBox["\[Alpha]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "+", 
         RowBox[{
          SubscriptBox["k", "x"], 
          RowBox[{"x", "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["k", "xt"], 
          RowBox[{
           RowBox[{"x", "'"}], "[", "t", "]"}]}]}], ")"}]}]}], "}"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"U0", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["k", "x"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "xt"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "\[Alpha]t"], " ", 
       RowBox[{
        SuperscriptBox["\[Alpha]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "\[Alpha]"], " ", 
       RowBox[{"\[Alpha]", "[", "t", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "x"], " ", 
         RowBox[{"x", "[", "t", "]"}]}], "+", 
        RowBox[{
         SubscriptBox["k", "xt"], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], " ", 
      RowBox[{"\[Alpha]", "[", "t", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0", "=", 
   RowBox[{"P", "-", 
    RowBox[{"(", "F3", ")"}], "+", "U0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7048031145377417`*^9, 3.704803126113441*^9}, {
  3.704803181473233*^9, 3.704803202768075*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["k", "\[Alpha]"]}], "+", 
      RowBox[{
       SubscriptBox["k", "x"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "xt"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "\[Alpha]t"], " ", 
       RowBox[{
        SuperscriptBox["\[Alpha]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"d", " ", "n"}], 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "3"]], "-", 
    FractionBox[
     RowBox[{"d", " ", "p"}], 
     RowBox[{"a", "[", "t", "]"}]], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]", "[", "t", "]"}], "]"}], " ", 
        SubscriptBox["k", "\[Alpha]"]}], "+", 
       RowBox[{
        SubscriptBox["k", "x"], " ", 
        RowBox[{"x", "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "xt"], " ", 
        RowBox[{
         SuperscriptBox["x", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]t"], " ", 
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7048032002595997`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ET", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["m", "0"], " ", 
      FractionBox[
       RowBox[{"v0", ".", "v0"}], "2"]}], "+", 
     RowBox[{
      SubscriptBox["m", "3"], " ", 
      FractionBox[
       RowBox[{"v3", ".", "v3"}], "2"]}], "+", 
     FractionBox[
      RowBox[{"J", " ", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "2"]}], "2"]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Alpha]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"a", "'"}], "[", "t", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}], ";"}]}], "Input",
 CellChangeTimes->{{3.704803538620117*^9, 3.704803541895051*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r0", ",", 
      RowBox[{"a", "[", "t", "]"}], ",", 
      RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
      RowBox[{"\[Alpha]", "[", "t", "]"}]}], "}"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"r0", ",", "#"}], "]"}], ".", "F0"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"r1", ",", "#"}], "]"}], ".", "F1"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"r2", ",", "#"}], "]"}], ".", "F2"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"r3", ",", "#"}], "]"}], ".", "F3"}]}], ")"}], "&"}], "/@", 
     "vars"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq0", "=", 
   RowBox[{
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"ET", ",", 
             RowBox[{"D", "[", 
              RowBox[{"#1", ",", "t"}], "]"}]}], "]"}], ",", "t"}], "]"}], 
         "-", 
         RowBox[{"D", "[", 
          RowBox[{"ET", ",", "#1"}], "]"}]}], "\[Equal]", 
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}]}], "&"}], ",", 
      "vars"}], "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{"eq0", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "}"}]}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.704804953194661*^9, 3.7048049758426247`*^9}}]
},
WindowSize->{808, 911},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1028, 24, 97, "Input"],
Cell[1589, 46, 2069, 66, 165, "Input"],
Cell[CellGroupData[{
Cell[3683, 116, 3581, 111, 174, "Input"],
Cell[7267, 229, 1806, 56, 80, "Output"]
}, Open  ]],
Cell[9088, 288, 1020, 34, 70, "Input"],
Cell[10111, 324, 2384, 72, 80, "Input"]
}
]
*)

(* End of internal cache information *)
