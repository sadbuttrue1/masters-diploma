(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     50862,       1468]
NotebookOptionsPosition[     49947,       1435]
NotebookOutlinePosition[     50303,       1451]
CellTagsIndexPosition[     50260,       1448]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"fontName", "=", "\"\<Times\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.002", "]"}], ",", "13", ",", "fontName"}],
       "]"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"GridLinesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.001", "]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"FontFamily", "\[Rule]", "fontName"}], ")"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ";", 
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.704048095654065*^9, 3.704048111343761*^9}, 
   3.7040482474061537`*^9, {3.7046415595774927`*^9, 3.704641568509088*^9}, {
   3.7046422307209044`*^9, 3.704642235196884*^9}, {3.7048026014362803`*^9, 
   3.704802601872793*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "d"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{"l", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L1", "=", 
   RowBox[{"-", "L2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["R", "a"], "=", 
   RowBox[{"L1", "-", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["R", "b"], "=", 
   RowBox[{"-", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["R", "c"], "=", 
   RowBox[{"L2", "-", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "a"], "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["R", "a"], ".", 
      SubscriptBox["R", "a"]}], ")"}], 
    RowBox[{"1", "/", "2"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "b"], "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["R", "b"], ".", 
      SubscriptBox["R", "b"]}], ")"}], 
    RowBox[{"1", "/", "2"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "c"], "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["R", "c"], ".", 
      SubscriptBox["R", "c"]}], ")"}], 
    RowBox[{"1", "/", "2"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704046951061146*^9, 3.704046978263829*^9}, {
   3.704048169978747*^9, 3.704048176998706*^9}, {3.704803212005309*^9, 
   3.7048032297687473`*^9}, {3.705478074249061*^9, 3.705478093790845*^9}, 
   3.7054980864519157`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", "ba"], "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]},
       {
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}
      }], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "l"}], ",", "0"}], " ", "}"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "bb"], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "bc"], "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]},
       {
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}
      }], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0"}], " ", "}"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cm", "=", 
   RowBox[{
    SubscriptBox["k", "c"], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "/", "R1"}], 
        RowBox[{"1", "/", 
         SubscriptBox["r", "a"]}], 
        RowBox[{"1", "/", 
         SubscriptBox["r", "b"]}], 
        RowBox[{"1", "/", 
         SubscriptBox["r", "c"]}]},
       {
        RowBox[{"1", "/", 
         SubscriptBox["r", "a"]}], 
        RowBox[{"1", "/", "R2a"}], 
        RowBox[{"1", "/", "l"}], 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "l"}], ")"}]}]},
       {
        RowBox[{"1", "/", 
         SubscriptBox["r", "b"]}], 
        RowBox[{"1", "/", "l"}], 
        RowBox[{"1", "/", "R2b"}], 
        RowBox[{"1", "/", "l"}]},
       {
        RowBox[{"1", "/", 
         SubscriptBox["r", "c"]}], 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "l"}], ")"}]}], 
        RowBox[{"1", "/", "l"}], 
        RowBox[{"1", "/", "R2c"}]}
      }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cm1", "=", 
   RowBox[{"Inverse", "[", "Cm", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", GridBox[{
      {"q10"},
      {"q2a"},
      {"q2b"},
      {"q2c"}
     }], ")"}], "=", 
   RowBox[{"Cm1", ".", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "\[CapitalPhi]"}]},
       {"\[CapitalPhi]"},
       {"\[CapitalPhi]"},
       {"\[CapitalPhi]"}
      }], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.704046980364995*^9, {3.70404701552675*^9, 3.7040470381043797`*^9}, {
   3.70404768899804*^9, 3.704047689751597*^9}, 3.7040481662223673`*^9, {
   3.7041225123405533`*^9, 3.704122512733076*^9}, 3.705477855723207*^9, {
   3.705478065599634*^9, 3.705478120904467*^9}, 3.705498081280129*^9, {
   3.705551325684054*^9, 3.705551330752372*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["F", 
    RowBox[{"2", "a"}]], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "c"], " ", "q10", " ", "q2a"}], 
      SuperscriptBox[
       SubscriptBox["r", "a"], "3"]]}], 
    SubscriptBox["R", "a"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["F", 
    RowBox[{"2", "b"}]], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "c"], "q10", " ", "q2b"}], 
      SuperscriptBox[
       SubscriptBox["r", "b"], "3"]]}], 
    SubscriptBox["R", "b"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["F", 
    RowBox[{"2", "c"}]], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "c"], " ", "q10", " ", "q2c"}], 
      SuperscriptBox[
       SubscriptBox["r", "c"], "3"]]}], 
    SubscriptBox["R", "c"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sa", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["k", "c"]}], "q2a", " ", "q10"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sc", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["k", "c"]}], "q2c", " ", "q10"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["F", 
    RowBox[{"2", "a1"}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"Sa", "[", "t", "]"}], 
      SuperscriptBox[
       SubscriptBox["r", "a"], "3"]], 
     SubscriptBox["R", "a"]}], "//.", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["F", 
    RowBox[{"2", "c1"}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"Sc", "[", "t", "]"}], 
      SuperscriptBox[
       SubscriptBox["r", "c"], "3"]], 
     SubscriptBox["R", "c"]}], "//.", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "0"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704048349015023*^9, 3.7040483519955177`*^9}, {
   3.70404840059758*^9, 3.7040484097317038`*^9}, {3.7040488081157513`*^9, 
   3.704048837129611*^9}, {3.704122480202039*^9, 3.7041224817052517`*^9}, 
   3.704127614367382*^9, {3.704127789826198*^9, 3.704127906196088*^9}, {
   3.704128003961095*^9, 3.704128038521853*^9}, {3.70412827684667*^9, 
   3.704128296938814*^9}, {3.7054982411219387`*^9, 3.7054982548447027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET", "=", 
   FractionBox[
    RowBox[{"J", " ", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "2"]}], "2"]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.704047072687406*^9, 3.704047073822898*^9}, 
   3.704122522273378*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["r", "ba"], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
     SubscriptBox["F", 
      RowBox[{"2", "a"}]]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["r", "bc"], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
     SubscriptBox["F", 
      RowBox[{"2", "c"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["r", "ba"], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
     SubscriptBox["F", 
      RowBox[{"2", "a1"}]]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["r", "bc"], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ".", 
     SubscriptBox["F", 
      RowBox[{"2", "c1"}]]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7040476932724752`*^9, {3.7040499409338093`*^9, 3.704049999421843*^9}, 
   3.704122525299821*^9, {3.7041280426398497`*^9, 3.704128064813078*^9}, 
   3.704642377963408*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "15"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=15_no_fix.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<MSM\>\"", "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=15_no_fix.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=15.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=15.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7040472473894567`*^9, 3.704047250620262*^9}, {
   3.704047490127185*^9, 3.70404755276791*^9}, {3.704047608761189*^9, 
   3.704047613590218*^9}, {3.704047653379834*^9, 3.704047669840857*^9}, {
   3.704047713332273*^9, 3.7040477218702183`*^9}, {3.704047778685089*^9, 
   3.704047957088503*^9}, {3.7040479888505697`*^9, 3.704048085705139*^9}, 
   3.704048229178104*^9, {3.704048369490447*^9, 3.7040483817533484`*^9}, {
   3.704048455757741*^9, 3.704048486053631*^9}, {3.7040485537694473`*^9, 
   3.7040485574587708`*^9}, {3.7040486594209414`*^9, 
   3.7040487170423203`*^9}, {3.704048748387434*^9, 3.704048755429484*^9}, {
   3.704048785434573*^9, 3.7040487926220512`*^9}, {3.704048851991683*^9, 
   3.704048852597924*^9}, {3.704048909423127*^9, 3.704049033501808*^9}, {
   3.704049078345695*^9, 3.704049082575399*^9}, {3.704049113929912*^9, 
   3.704049117292656*^9}, {3.7040496059604177`*^9, 3.704049617557013*^9}, {
   3.704049944847546*^9, 3.7040499463101587`*^9}, {3.704123135125059*^9, 
   3.704123155682773*^9}, {3.704123225299347*^9, 3.704123247395302*^9}, {
   3.704123746422818*^9, 3.704123769258024*^9}, {3.70412406186686*^9, 
   3.7041241190638933`*^9}, {3.704124247136025*^9, 3.704124252850668*^9}, {
   3.704125729086027*^9, 3.7041257556780376`*^9}, {3.704127002658719*^9, 
   3.7041270691130943`*^9}, {3.704127117884646*^9, 3.7041271245543423`*^9}, {
   3.7041273280280323`*^9, 3.704127510095818*^9}, {3.70412757215522*^9, 
   3.7041275740786057`*^9}, {3.7041280764348907`*^9, 3.704128147479858*^9}, {
   3.704128303813751*^9, 3.7041283042178173`*^9}, {3.7041284253049183`*^9, 
   3.704128484975016*^9}, {3.704640133681731*^9, 3.704640160938426*^9}, {
   3.7046402043764057`*^9, 3.704640218359276*^9}, {3.7046402701708603`*^9, 
   3.7046402769959927`*^9}, {3.70464046801374*^9, 3.704640531497099*^9}, {
   3.704640618294304*^9, 3.704640643336195*^9}, {3.704640906996455*^9, 
   3.7046409552508*^9}, {3.704641008327962*^9, 3.704641145761567*^9}, {
   3.704641268490634*^9, 3.704641280191077*^9}, {3.704641574101057*^9, 
   3.70464162822567*^9}, {3.704641715281329*^9, 3.7046417868043823`*^9}, {
   3.7046418899631042`*^9, 3.704641898975209*^9}, {3.704641934334777*^9, 
   3.704641945242744*^9}, {3.7046421786333447`*^9, 3.70464218565201*^9}, 
   3.704642275568398*^9, 3.704642367111195*^9, {3.70464261114715*^9, 
   3.7046426318920107`*^9}, 3.7049523439866257`*^9, {3.705478649856398*^9, 
   3.705478686994437*^9}, {3.7054788576496353`*^9, 3.70547888211893*^9}, {
   3.7054813216357183`*^9, 3.705481322800716*^9}, {3.705481430315001*^9, 
   3.705481434207223*^9}, {3.705498273775708*^9, 3.705498295195096*^9}, {
   3.705752509582281*^9, 3.7057525101339417`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "20"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "150000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=20.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=20.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.704641842096449*^9, 3.7046418618813066`*^9}, {
   3.704641907479596*^9, 3.7046419193040047`*^9}, {3.704641952143949*^9, 
   3.704641982935073*^9}, {3.704642035036541*^9, 3.70464203527033*^9}, 
   3.7049523402701387`*^9, {3.705481414069721*^9, 3.705481416139785*^9}, {
   3.705498276688204*^9, 3.7054982956793537`*^9}, 3.70575251062724*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "10"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "50000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=10.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=10.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7046427317152443`*^9, 3.704642755059299*^9}, 
   3.70495233504992*^9, {3.704952407209858*^9, 3.704952415859639*^9}, {
   3.705481417500162*^9, 3.7054814183775377`*^9}, {3.705498277756929*^9, 
   3.7054982963766193`*^9}, 3.70575251112234*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "5"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "16000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=5.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=5.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704642802659071*^9, 3.704642870813011*^9}, 
   3.704952328638226*^9, {3.704952411664091*^9, 3.704952430384251*^9}, {
   3.705481419390419*^9, 3.7054814201331673`*^9}, {3.7054982789733133`*^9, 
   3.705498296871395*^9}, 3.7057525116741323`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "2.5"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "3800"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=2.5.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=2.5.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704642901525741*^9, 3.7046429392703238`*^9}, 
   3.7049523244651833`*^9, {3.704952435683663*^9, 3.704952441165874*^9}, {
   3.705481420819466*^9, 3.705481421617681*^9}, {3.705498279805238*^9, 
   3.705498297422385*^9}, {3.705752497034354*^9, 3.7057524986857967`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "\[Rule]", "20000"}], ",", 
     RowBox[{
      SubscriptBox["k", "c"], "\[Rule]", 
      RowBox[{"8.99", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"R2a", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2c", "\[Rule]", ".59"}], ",", 
     RowBox[{"R2b", "\[Rule]", ".65"}], ",", 
     RowBox[{"R1", "\[Rule]", ".5"}], ",", 
     RowBox[{"l", "\[Rule]", "1.5"}], ",", 
     RowBox[{"d", "\[Rule]", "1.8"}], ",", 
     RowBox[{"J", "\[Rule]", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", "1300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q1"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ET", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], 
        ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"ET", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "Q2"}], "//.",
     "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "1."}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0."}]}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tk"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_theta_d=1.8.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol2"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MSM\>\"", ",", "\"\<Fixed\>\""}], "}"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<images/msm_flow_d=1.8.png\>\"", ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sc", "[", "t", "]"}], "//.", "params"}], "/.", "sol"}], 
           "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sa", "[", "t", "]"}], "//.", "params"}], "//.", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tk"}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<t,s\>\"", ",", "\"\<\[Theta]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Sa\>\"", ",", "\"\<Sc\>\"", ",", "\"\<Fixed\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t,s\>\"", ",", "\"\<S\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Left"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704642972267405*^9, 3.704642999459049*^9}, {
   3.704952275132491*^9, 3.704952287236697*^9}, 3.7049523200599737`*^9, {
   3.704952448036643*^9, 3.704952453142674*^9}, {3.705481422574497*^9, 
   3.705481423417716*^9}, {3.705498280603574*^9, 3.705498297704145*^9}, {
   3.705752492559374*^9, 3.705752493488195*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"InputNotebook", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fn", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<3spheres.txt\>\""}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"FrontEndExecute", "[", 
  RowBox[{"FrontEndToken", "[", 
   RowBox[{"nb", ",", "\"\<Save\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"fn", ",", "\"\<Text\>\""}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7054822903980293`*^9, 3.705482290398817*^9}, {
   3.70548238549013*^9, 3.7054824232114277`*^9}, 3.7057524847987213`*^9, 
   3.7057525323953743`*^9}]
},
WindowSize->{1469, 1235},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 1206, 27, 80, "Input"],
Cell[1609, 42, 1865, 62, 171, "Input"],
Cell[3477, 106, 3248, 109, 271, "Input"],
Cell[6728, 217, 2445, 80, 256, "Input"],
Cell[9176, 299, 299, 10, 50, "Input"],
Cell[9478, 311, 1176, 38, 46, "Input"],
Cell[10657, 351, 10191, 250, 291, "Input"],
Cell[20851, 603, 5755, 161, 223, "Input"],
Cell[26609, 766, 5633, 160, 206, "Input"],
Cell[32245, 928, 5632, 160, 206, "Input"],
Cell[37880, 1090, 5661, 160, 206, "Input"],
Cell[43544, 1252, 5707, 161, 206, "Input"],
Cell[49254, 1415, 689, 18, 63, "Input"]
}
]
*)

